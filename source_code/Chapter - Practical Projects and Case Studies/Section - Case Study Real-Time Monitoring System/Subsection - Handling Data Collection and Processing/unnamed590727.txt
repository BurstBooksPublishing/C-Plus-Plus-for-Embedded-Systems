template
class CircularBuffer {
public:
    void push(float value) {
        buffer[tail] = value;
        tail = (tail + 1) % N;
        if (size < N) ++size;
    }
    float average() const {
        float sum = 0.0f;
        for (size_t i = 0; i < size; ++i) {
            sum += buffer[(tail - size + i + N) % N];
        }
        return sum / size;
    }
private:
    float buffer[N] = {0.0f};
    size_t tail = 0;
    size_t size = 0;
};